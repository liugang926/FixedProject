{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/ND/Desktop/Fixed_Project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/ND/Desktop/Fixed_Project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { defineComponent, ref, reactive, computed } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { getUserList, createUser, updateUser, deleteUser, lockUser, unlockUser } from '@/api/user';\nexport default defineComponent({\n  name: 'UserList',\n  setup: function setup() {\n    var userList = ref([]);\n    var dialogVisible = ref(false);\n    var dialogType = ref('add');\n    var userFormRef = ref(null);\n    var userForm = reactive({\n      username: '',\n      email: '',\n      phone: '',\n      password: ''\n    });\n    var userRules = {\n      username: [{\n        required: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }, {\n        pattern: /^[a-zA-Z][a-zA-Z0-9_]{3,19}$/,\n        message: '用户名格式不正确',\n        trigger: 'blur'\n      }],\n      email: [{\n        required: true,\n        message: '请输入邮箱',\n        trigger: 'blur'\n      }, {\n        type: 'email',\n        message: '邮箱格式不正确',\n        trigger: 'blur'\n      }],\n      phone: [{\n        required: true,\n        message: '请输入手机号',\n        trigger: 'blur'\n      }, {\n        pattern: /^1[3-9]\\d{9}$/,\n        message: '手机号格式不正确',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 8,\n        max: 16,\n        message: '密码长度在8-16位之间',\n        trigger: 'blur'\n      }]\n    };\n    var dialogTitle = computed(function () {\n      return dialogType.value === 'add' ? '新增用户' : '编辑用户';\n    });\n\n    // 获取用户列表\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _yield$getUserList, data;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getUserList();\n            case 3:\n              _yield$getUserList = _context.sent;\n              data = _yield$getUserList.data;\n              userList.value = data;\n              _context.next = 12;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('获取用户列表失败:', _context.t0);\n              ElMessage.error('获取用户列表失败');\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    // 处理用户表单提交\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var _userFormRef$value;\n        var _error$response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return (_userFormRef$value = userFormRef.value) === null || _userFormRef$value === void 0 ? void 0 : _userFormRef$value.validate();\n            case 2:\n              _context2.prev = 2;\n              if (!(dialogType.value === 'add')) {\n                _context2.next = 9;\n                break;\n              }\n              _context2.next = 6;\n              return createUser(userForm);\n            case 6:\n              ElMessage.success('创建成功');\n              _context2.next = 12;\n              break;\n            case 9:\n              _context2.next = 11;\n              return updateUser(userForm.id, userForm);\n            case 11:\n              ElMessage.success('更新成功');\n            case 12:\n              dialogVisible.value = false;\n              fetchData();\n              _context2.next = 19;\n              break;\n            case 16:\n              _context2.prev = 16;\n              _context2.t0 = _context2[\"catch\"](2);\n              ElMessage.error(((_error$response = _context2.t0.response) === null || _error$response === void 0 || (_error$response = _error$response.data) === null || _error$response === void 0 ? void 0 : _error$response.message) || '操作失败');\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 16]]);\n      }));\n      return function handleSubmit() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    // 其他处理函数...\n\n    return {\n      userList: userList,\n      dialogVisible: dialogVisible,\n      dialogType: dialogType,\n      userForm: userForm,\n      userRules: userRules,\n      userFormRef: userFormRef,\n      dialogTitle: dialogTitle,\n      handleSubmit: handleSubmit\n      // ... 其他返回值\n    };\n  }\n});","map":{"version":3,"names":["defineComponent","ref","reactive","computed","ElMessage","ElMessageBox","getUserList","createUser","updateUser","deleteUser","lockUser","unlockUser","name","setup","userList","dialogVisible","dialogType","userFormRef","userForm","username","email","phone","password","userRules","required","message","trigger","pattern","type","min","max","dialogTitle","value","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$getUserList","data","wrap","_callee$","_context","prev","next","sent","t0","console","error","stop","apply","arguments","handleSubmit","_ref2","_callee2","_userFormRef$value","_error$response","_callee2$","_context2","validate","success","id","response"],"sources":["C:\\Users\\ND\\Desktop\\Fixed_Project\\frontend\\src\\views\\user\\UserList.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-list\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"header\">\r\n          <span>用户管理</span>\r\n          <div class=\"right\">\r\n            <el-button type=\"primary\" @click=\"handleAdd\">新增用户</el-button>\r\n            <el-button @click=\"handleImport\">批量导入</el-button>\r\n            <el-button @click=\"handleExport\">导出</el-button>\r\n          </div>\r\n        </div>\r\n      </template>\r\n\r\n      <el-table :data=\"userList\" border style=\"width: 100%\">\r\n        <el-table-column prop=\"username\" label=\"用户名\" />\r\n        <el-table-column prop=\"email\" label=\"邮箱\" />\r\n        <el-table-column prop=\"phone\" label=\"手机号\" />\r\n        <el-table-column prop=\"is_active\" label=\"状态\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"row.is_active ? 'success' : 'danger'\">\r\n              {{ row.is_active ? '启用' : '禁用' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"is_locked\" label=\"锁定状态\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"row.is_locked ? 'danger' : 'success'\">\r\n              {{ row.is_locked ? '已锁定' : '正常' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"300\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <el-button-group>\r\n              <el-button size=\"small\" @click=\"handleEdit(row)\">编辑</el-button>\r\n              <el-button \r\n                size=\"small\" \r\n                :type=\"row.is_locked ? 'success' : 'warning'\"\r\n                @click=\"handleLockToggle(row)\"\r\n              >\r\n                {{ row.is_locked ? '解锁' : '锁定' }}\r\n              </el-button>\r\n              <el-button \r\n                size=\"small\" \r\n                type=\"danger\" \r\n                @click=\"handleDelete(row)\"\r\n              >\r\n                删除\r\n              </el-button>\r\n            </el-button-group>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <!-- 用户表单对话框 -->\r\n    <el-dialog\r\n      :title=\"dialogTitle\"\r\n      v-model=\"dialogVisible\"\r\n      width=\"500px\"\r\n    >\r\n      <el-form\r\n        ref=\"userFormRef\"\r\n        :model=\"userForm\"\r\n        :rules=\"userRules\"\r\n        label-width=\"100px\"\r\n      >\r\n        <el-form-item label=\"用户名\" prop=\"username\">\r\n          <el-input v-model=\"userForm.username\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"userForm.email\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"手机号\" prop=\"phone\">\r\n          <el-input v-model=\"userForm.phone\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" prop=\"password\" v-if=\"dialogType === 'add'\">\r\n          <el-input\r\n            v-model=\"userForm.password\"\r\n            type=\"password\"\r\n            show-password\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSubmit\">确定</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, ref, reactive, computed } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { getUserList, createUser, updateUser, deleteUser, lockUser, unlockUser } from '@/api/user'\r\n\r\nexport default defineComponent({\r\n  name: 'UserList',\r\n  setup() {\r\n    const userList = ref([])\r\n    const dialogVisible = ref(false)\r\n    const dialogType = ref('add')\r\n    const userFormRef = ref(null)\r\n\r\n    const userForm = reactive({\r\n      username: '',\r\n      email: '',\r\n      phone: '',\r\n      password: ''\r\n    })\r\n\r\n    const userRules = {\r\n      username: [\r\n        { required: true, message: '请输入用户名', trigger: 'blur' },\r\n        { pattern: /^[a-zA-Z][a-zA-Z0-9_]{3,19}$/, message: '用户名格式不正确', trigger: 'blur' }\r\n      ],\r\n      email: [\r\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n        { type: 'email', message: '邮箱格式不正确', trigger: 'blur' }\r\n      ],\r\n      phone: [\r\n        { required: true, message: '请输入手机号', trigger: 'blur' },\r\n        { pattern: /^1[3-9]\\d{9}$/, message: '手机号格式不正确', trigger: 'blur' }\r\n      ],\r\n      password: [\r\n        { required: true, message: '请输入密码', trigger: 'blur' },\r\n        { min: 8, max: 16, message: '密码长度在8-16位之间', trigger: 'blur' }\r\n      ]\r\n    }\r\n\r\n    const dialogTitle = computed(() => dialogType.value === 'add' ? '新增用户' : '编辑用户')\r\n\r\n    // 获取用户列表\r\n    const fetchData = async () => {\r\n      try {\r\n        const { data } = await getUserList()\r\n        userList.value = data\r\n      } catch (error) {\r\n        console.error('获取用户列表失败:', error)\r\n        ElMessage.error('获取用户列表失败')\r\n      }\r\n    }\r\n\r\n    // 处理用户表单提交\r\n    const handleSubmit = async () => {\r\n      await userFormRef.value?.validate()\r\n      try {\r\n        if (dialogType.value === 'add') {\r\n          await createUser(userForm)\r\n          ElMessage.success('创建成功')\r\n        } else {\r\n          await updateUser(userForm.id, userForm)\r\n          ElMessage.success('更新成功')\r\n        }\r\n        dialogVisible.value = false\r\n        fetchData()\r\n      } catch (error) {\r\n        ElMessage.error(error.response?.data?.message || '操作失败')\r\n      }\r\n    }\r\n\r\n    // 其他处理函数...\r\n\r\n    return {\r\n      userList,\r\n      dialogVisible,\r\n      dialogType,\r\n      userForm,\r\n      userRules,\r\n      userFormRef,\r\n      dialogTitle,\r\n      handleSubmit,\r\n      // ... 其他返回值\r\n    }\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.user-list {\r\n  .header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    \r\n    .right {\r\n      display: flex;\r\n      gap: 10px;\r\n    }\r\n  }\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}